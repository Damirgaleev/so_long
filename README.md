# so_long
Цель проекта: написать маленькую 2D игру, используя библиотеку minilibx, предоставленную школой 21.

Цель игры: необходимо собрать все предметы коллекционирования, после этого разблокируется выход. Если условия выполнены и мы дошли до выхода - игра завершается.

Как устроен проект: здесь я опишу примерное построение проекта шаг за шагом.

1) необходимо проверить какие и сколько аргументов подается. По проекту, мы работаем с первым аргументом, у которого должно быть расширение <.ber>. Если аргумента нет - программа завершается, если аргументов больше - я вывожу предупреждение "будет обработан только первый аргумент".

2) считаем необходимое колличество строк и столбцов нашей карты. Далее мы копируем нашу карту в массив строк, который заранее замолочен. Данный массив строк находится в структуре t_map.

3) следующим шагом мы пробежимся по массиву и проверим контент, по проекту должно быть: один игрок (P), хотя бы один предмет коллекционирования (C), один выход (E). Для удобства колличество предметов коллекционирования я сразу положил в отдельную переменную в структуре t_map. Так же по условиям проекта вокруг карты должны быть стены (1). Если все хорошо, для удобства работы, присвоим указателю t_map из основной структуры t_game структуру t_map со всеми данными.

4) создадим соединение с помощью функции mlx_init. возвращаемое значение положим в указатель нашей основной структуры t_game. 

5) укажем пути наших изображений (формат xmp). Для этого используем функцию mlx_xpm_file_to_image. Возвращаемые значения я кладу в переменные структуры t_img. Для удобсства работы в основной структуре t_game у меня есть указатель t_img, которому я присваиваю адрес структуры t_img со всеми данными.

6) создадим новое окно с помощью функции mlx_new_window. Возвращаемое значение положим в переменную основной структуры. Размер окна должен уместить все изображения, каждое поле на карте - это одно изображение, поэтому каждое поле нужно умножить на размер изображений. Я это сделал выше, присвоив эти значения полям в основной структуре t_game.

7) заполним наше окно. Для этого я использую функцию mlx_put_image_to_window (при использовании этой функции не забывайте умножить аргументы координат на размер изображений). Сначала я заполню все окно полом, далее проходя по карте, вставляю выход, коллекционные предметы и игрока. Положение координат игрока я сохраняю в отдельные переменные структуры t_game.

8) на данный момент если на нашем окне нажать на крестик, окно закроется, но программа не завершиться. с помощью функции mlx_hook реализуем заершение программы по нажатию на крестик. Подробное описание функции читайте в руководстве библиотеки, в моем случае, она прослушивает событие нажатия кнопки мыши по крестику, когда это событие происходит вызывается функция, указанная в параметре mlx_hook, так же на вход этой функции передается аргумент - вся структура t_game.

9) осталось научить нашу программу ходить, собирать предметы и выходит из игры через поле E. Для этого я использую функцию mlx_key_hook, которая прослушивает события нажатия на клавиши и запускает функцию переданную в парметрах с аргументом, который так же передан в параметрах(t_game). Кроме самой структуры функция будет принимать int значение - это будет код нашей клавиши. Что бы узнать коды клавиш через эту функцию можете просто печатать значение на консоль. По клавише мы узнаем в каком направлении мы двигаемся, соответсвенно какую координату менять. Перед ходом, я заполняю положение игрока изображением пола, проверяю что находится в координате движения. Если это стена или если это выход, а не все предметы собраны, координата игрока не меняется и я вставляю изображение игрока на то же место. В другом случае координаты игрока меняются и происходит вставка изображения игрока уже по новым координатам. Если мы наткнулись на коллекционный предмет, мы меняем его значение в карте с 'C' на '0' и инкрементируем значение в поле структуры t_game. Если все предметы собраны и мы натыкаемся на поле выхода - завершаем игру.

10) последнее что нужно сделать, запустить цикл открытого окна с помощью функции mlx_loop.

P.S. не забывайте освождать выделенную память, всякий раз при выходе из программы. Я не описывал все инструкции по условиям проекта, такие как выводы в консоль - читайте правила. Удачного кода!
